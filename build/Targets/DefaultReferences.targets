<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Choose>
    <When Condition="'$(ProjectSystemLayer)' == 'HostAgnostic'">
      <PropertyGroup>
        <IncludeHostAgnosticReferences>true</IncludeHostAgnosticReferences>
        <IncludeVisualStudioReferences>false</IncludeVisualStudioReferences>
        <IncludeVisualStudioDesignerReferences>false</IncludeVisualStudioDesignerReferences>
      </PropertyGroup>
    </When>
    <When Condition="'$(ProjectSystemLayer)' == 'VisualStudio'">
      <PropertyGroup>
        <IncludeHostAgnosticReferences>true</IncludeHostAgnosticReferences>
        <IncludeVisualStudioReferences>true</IncludeVisualStudioReferences>
        <IncludeVisualStudioDesignerReferences>false</IncludeVisualStudioDesignerReferences>
      </PropertyGroup>
    </When>
    <When Condition="'$(ProjectSystemLayer)' == 'VisualStudioDesigner'">
      <PropertyGroup>
        <IncludeHostAgnosticReferences>true</IncludeHostAgnosticReferences>
        <IncludeVisualStudioReferences>true</IncludeVisualStudioReferences>
        <IncludeVisualStudioDesignerReferences>true</IncludeVisualStudioDesignerReferences>
      </PropertyGroup>
    </When>
  </Choose>


  <!-- Don't be tempted to move this to conditional ItemGroup or <References> csproj/msvbprj do not like this-->
  <Choose>
    <When Condition="'$(IncludeHostAgnosticReferences)' == 'true'">
      <ItemGroup>

        <!-- Framework -->
        <Reference Include="System" />
        <Reference Include="System.ComponentModel.Composition" />
        <Reference Include="System.Core" />
        <Reference Include="System.Xaml" />
        <Reference Include="System.Xml" />
        <Reference Include="System.Xml.Linq" />

        <!-- MSBuild -->
        <Reference Include="Microsoft.Build, Version=15.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
        <Reference Include="Microsoft.Build.Framework, Version=15.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
        <Reference Include="Microsoft.Build.Tasks.Core, Version=15.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />

      </ItemGroup>
    </When>
  </Choose>

  <Choose>
    <When Condition="'$(IncludeVisualStudioReferences)' == 'true'">
      <ItemGroup>

        <!-- Visual Studio -->
        <Reference Include="EnvDTE, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        <Reference Include="EnvDTE80, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        <Reference Include="Microsoft.VisualStudio.ComponentModelHost, Version=14.0.0.0" />
      </ItemGroup>
    </When>
  </Choose>

  <Choose>
    <When Condition="'$(IncludeVisualStudioDesignerReferences)' == 'true'">

      <ItemGroup>
        <!-- Framework -->
        <Reference Include="CustomMarshalers" />
        <Reference Include="System.Configuration" />
        <Reference Include="System.Data" />
        <Reference Include="System.Design" />
        <Reference Include="System.Drawing" />
        <Reference Include="System.Web.ApplicationServices" />
        <Reference Include="System.Web.Extensions" />
        <Reference Include="System.Windows.Forms" />
        <Reference Include="PresentationFramework" />
        <Reference Include="PresentationCore" />
        <Reference Include="WindowsBase" />

        <!-- Visual Studio -->
        <Reference Include="Microsoft.VisualStudio.VSHelp" />
        <Reference Include="VSLangProj" />
        <Reference Include="VSLangProj2" />
        <Reference Include="VSLangProj80" />
        <Reference Include="VSLangProj90" />
        <Reference Include="VSLangProj100" />
        <Reference Include="VSLangProj110">
          <EmbedInteropTypes>true</EmbedInteropTypes>
        </Reference>
        <Reference Include="VsWebSite.Interop" />
        <Reference Include="Microsoft.VSDesigner" />
        <Reference Include="Microsoft.VSDesigner.WCF" />
        <Reference Include="Microsoft.VisualStudio.TemplateWizardInterface" />
        <Reference Include="Microsoft.VisualStudio.XmlEditor" />

        <Reference Include="Microsoft.VisualStudio.DataDesign.Common" />
        <Reference Include="Microsoft.VisualStudio.DataTools.Interop">
          <HintPath>$(DevEnvDir)\Microsoft.VisualStudio.DataTools.Interop.dll</HintPath>
        </Reference>
      </ItemGroup>
    </When>
  </Choose>

</Project>
