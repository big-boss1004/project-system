<Project ToolsVersion="4.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <Choose>
    <When Condition="'$(ProjectSystemLayer)' == 'Dependency'">
      <PropertyGroup>
        <IncludeHostAgnosticReferences>false</IncludeHostAgnosticReferences>
        <IncludeVisualStudioReferences>false</IncludeVisualStudioReferences>
        <IncludeVisualStudioDesignerReferences>false</IncludeVisualStudioDesignerReferences>
      </PropertyGroup>
    </When>
    <When Condition="'$(ProjectSystemLayer)' == 'HostAgnostic'">
      <PropertyGroup>
        <IncludeHostAgnosticReferences>true</IncludeHostAgnosticReferences>
        <IncludeVisualStudioReferences>false</IncludeVisualStudioReferences>
        <IncludeVisualStudioDesignerReferences>false</IncludeVisualStudioDesignerReferences>
      </PropertyGroup>
    </When>
    <When Condition="'$(ProjectSystemLayer)' == 'VisualStudio'">
      <PropertyGroup>
        <IncludeHostAgnosticReferences>true</IncludeHostAgnosticReferences>
        <IncludeVisualStudioReferences>true</IncludeVisualStudioReferences>
        <IncludeVisualStudioDesignerReferences>false</IncludeVisualStudioDesignerReferences>
      </PropertyGroup>
    </When>
    <When Condition="'$(ProjectSystemLayer)' == 'VisualStudioDesigner'">
      <PropertyGroup>
        <IncludeHostAgnosticReferences>true</IncludeHostAgnosticReferences>
        <IncludeVisualStudioReferences>true</IncludeVisualStudioReferences>
        <IncludeVisualStudioDesignerReferences>true</IncludeVisualStudioDesignerReferences>
      </PropertyGroup>
    </When>
  </Choose>

  <!-- Don't be tempted to move this to conditional ItemGroup or <References> csproj/msvbprj do not like this-->
  <Choose>
    <When Condition="'$(IncludeHostAgnosticReferences)' == 'true'">
      <ItemGroup>

        <!-- Framework -->
        <Reference Include="System" />
        <Reference Include="System.ComponentModel.Composition" />
        <Reference Include="System.Core" />
        <Reference Include="System.Xaml" />
        <Reference Include="System.Xml" />
        <Reference Include="System.Xml.Linq" />

        <!-- MSBuild -->
        <Reference Include="Microsoft.Build, Version=15.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
        <Reference Include="Microsoft.Build.Framework, Version=15.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />
        <Reference Include="Microsoft.Build.Tasks.Core, Version=15.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a, processorArchitecture=MSIL" />

        <!-- NuGet Dependencies -->
        <ProjectReference Include="$(MSBuildThisFileDirectory)..\..\src\Dependencies\Roslyn\Roslyn.csproj">
          <Project>{cf97a73f-f2f1-4893-960c-9c2b95738870}</Project>
          <Name>Roslyn</Name>
        </ProjectReference>
        <ProjectReference Include="$(MSBuildThisFileDirectory)..\..\src\Dependencies\Composition\Composition.csproj">
          <Project>{a57ddfe5-ab0e-4371-98e5-11b9218df11c}</Project>
          <Name>Composition</Name>
        </ProjectReference>
        <ProjectReference Include="$(MSBuildThisFileDirectory)..\..\src\Dependencies\Immutable\Immutable.csproj">
          <Project>{dcda908d-ef5e-494b-addc-c26f5fd610ca}</Project>
          <Name>Immutable</Name>
        </ProjectReference>
        <ProjectReference Include="$(MSBuildThisFileDirectory)..\..\src\Dependencies\Metadata\Metadata.csproj">
          <Project>{e6796b97-d5c6-45b2-ae46-351d15dcfc71}</Project>
          <Name>Metadata</Name>
        </ProjectReference>
        
      </ItemGroup>
    </When>
  </Choose>

  <Choose>
    <When Condition="'$(IncludeVisualStudioReferences)' == 'true'">
      <ItemGroup>

        <!-- Visual Studio -->
        <Reference Include="EnvDTE, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        <Reference Include="EnvDTE80, Version=8.0.0.0, Culture=neutral, PublicKeyToken=b03f5f7f11d50a3a" />
        <Reference Include="Microsoft.VisualStudio.ComponentModelHost, Version=14.0.0.0" />

        <!-- NuGet Dependencies -->
        <ProjectReference Include="..\Dependencies\VisualStudio\VisualStudio.csproj">
          <Project>{8da861d8-0cce-4334-b6c0-01a846c881ec}</Project>
          <Name>VisualStudio</Name>
        </ProjectReference>
        
      </ItemGroup>
      
    </When>
  </Choose>

  <Choose>
    <When Condition="'$(IncludeVisualStudioDesignerReferences)' == 'true'">

      <ItemGroup>
        <!-- Framework -->
        <Reference Include="CustomMarshalers" />
        <Reference Include="System.Configuration" />
        <Reference Include="System.Data" />
        <Reference Include="System.Design" />
        <Reference Include="System.Drawing" />
        <Reference Include="System.Web.ApplicationServices" />
        <Reference Include="System.Web.Extensions" />
        <Reference Include="System.Windows.Forms" />
        <Reference Include="PresentationFramework" />
        <Reference Include="PresentationCore" />
        <Reference Include="WindowsBase" />

        <!-- Visual Studio -->
        <Reference Include="Microsoft.VisualStudio.VSHelp" />
        <Reference Include="VSLangProj" />
        <Reference Include="VSLangProj2" />
        <Reference Include="VSLangProj80" />
        <Reference Include="VSLangProj90" />
        <Reference Include="VSLangProj100" />
        <Reference Include="VSLangProj110">
          <EmbedInteropTypes>true</EmbedInteropTypes>
        </Reference>
        <Reference Include="VsWebSite.Interop" />
        <Reference Include="Microsoft.VSDesigner" />
        <Reference Include="Microsoft.VSDesigner.WCF" />
        <Reference Include="Microsoft.VisualStudio.TemplateWizardInterface" />
        <Reference Include="Microsoft.VisualStudio.XmlEditor" />
        <Reference Include="Microsoft.VisualStudio.DataDesign.Common" />
        <Reference Include="Microsoft.VisualStudio.DataTools.Interop">
          <HintPath>$(DevEnvDir)\Microsoft.VisualStudio.DataTools.Interop.dll</HintPath>
        </Reference>
      </ItemGroup>
    </When>
  </Choose>

</Project>
